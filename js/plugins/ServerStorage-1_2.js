//=============================================================================
// ServerStorage.js
//=============================================================================
/*:
 * @plugindesc OPEN GAME用サーバーセーブプラグイン ver1.2
 * @author 株式会社バンダイナムコエンターテインメント
 * @version 1.2 2016/07/20 RPGツクールMVでプラグイン選択した際に正常に読み込めない問題を修正。
 * 1.1 2016/07/14 Firefoxでサーバーセーブに失敗する不具合を修正。
 * 1.0 2016/07/14 公開。
 *
 * @help
 * RPGツクールMV専用のプラグインです。
 * 当プラグインを入れることで、ゲームデータや各種設定内容の保存先を、
 * ブラウザのWebストレージからOPEN GAMEサーバーストレージに変更します。
 * これによりOPEN GAME内でマルチデバイスでセーブデータを共有できるようになります。
 */

(function(){StorageManager.saveToWebStorage=function(c,b){var a=this.webStorageKey(c);var d=LZString.compressToBase64(b);this.saveToServerStorage(a,d)};StorageManager.loadFromWebStorage=function(b){var a=this.webStorageKey(b);var c=this.loadFromServerStorage(a);return LZString.decompressFromBase64(c)};StorageManager.webStorageExists=function(b){var a=this.webStorageKey(b);return !!this.loadFromServerStorage(a)};StorageManager.removeWebStorage=function(b){var a=this.webStorageKey(b);this.removeFromServerStorage(a)};StorageManager.saveToServerStorage=function(b,d){var g=this.getQueryParam();var f=sessionStorage.getItem(g.id+"_"+g.token+"_"+b);if(f!=d){sessionStorage.setItem(g.id+"_"+g.token+"_"+b,d);var c="sessionStorage";var e=new XMLHttpRequest();var h=CybozuLabs.MD5.calc(d+g.token+c);var a="mode=save&key="+encodeURIComponent(b).replace(/%20/g,"+")+"&data="+encodeURIComponent(d).replace(/%20/g,"+")+"&data2="+encodeURIComponent(h).replace(/%20/g,"+")+"&token="+encodeURIComponent(g.token).replace(/%20/g,"+");e.open("POST",g.dm+"/apiServerStorage_1_1.php",false);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");e.send(a);if(e.status===400){location.href="/"}else{if(e.status!==200){alert("Error. Failed to Save. Please Retry Later")}}}};StorageManager.loadFromServerStorage=function(b){var d=this.getQueryParam();if(sessionStorage.getItem(d.id+"_"+d.token)==1){return sessionStorage.getItem(d.id+"_"+d.token+"_"+b)}var c=new XMLHttpRequest();var a="mode=load_all&token="+encodeURIComponent(d.token).replace(/%20/g,"+");c.open("POST",d.dm+"/apiServerStorage_1_1.php",false);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.send(a);if(c.status===400){location.href="/"}else{if(c.status!==200){alert("Error, Please Retry Later.")}else{sessionStorage.setItem(d.id+"_"+d.token,1);JSON.parse(c.response,function(f,e){sessionStorage.setItem(d.id+"_"+d.token+"_"+f,e)});return sessionStorage.getItem(d.id+"_"+d.token+"_"+b)}}};StorageManager.removeFromServerStorage=function(b){var d=this.getQueryParam();var c=new XMLHttpRequest();var a="mode=remove&key="+encodeURIComponent(b).replace(/%20/g,"+")+"&token="+encodeURIComponent(d.token).replace(/%20/g,"+");c.open("POST",d.dm+"/apiServerStorage_1_1.php",false);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.send(a);if(c.status===400){location.href="/"}else{if(c.status!==200){alert("Error, Please Retry Later.")}else{sessionStorage.removeItem(d.id+"_"+d.token+"_"+b)}}};StorageManager.getQueryParam=function(){var f={};var d=window.location.search.substring(1);var e=d.split("&");for(var b=0;b<e.length;b++){var a=e[b].split("=");f[a[0]]=a[1]}if(f.token==undefined){location.href="/"}if(f.id==undefined){location.href="/"}if(f.dm==undefined){location.href="/"}var c=new RegExp("^http(s)*://[a-z-.]+$");if(!c.test(f.dm)||(f.dm.indexOf("open-game")!=-1&&f.dm.indexOf("opengame")!=-1)){location.href="/"}return f}})();

/*
MD5
Copyright (C) 2007 MITSUNARI Shigeo at Cybozu Labs, Inc.
license:new BSD license
*/
var CybozuLabs={MD5:{int2hex8_Fx:function(a){return this.int2hex8((a[1]*65536)+a[0])},update_Fx:function(l,J){var s=this.a_[0];var v=this.a_[1];var j=this.b_[0];var k=this.b_[1];var I=this.c_[0];var L=this.c_[1];var u=this.d_[0];var w=this.d_[1];var G,F,E,D,C,B,A,z,y,x,i,h,g,f,e,d;var c,b,a,R,Q,P,O,N,M,K,r,q,p,o,n,m;if(J==1){G=l.charCodeAt(0)|(l.charCodeAt(1)<<8);c=l.charCodeAt(2)|(l.charCodeAt(3)<<8);F=l.charCodeAt(4)|(l.charCodeAt(5)<<8);b=l.charCodeAt(6)|(l.charCodeAt(7)<<8);E=l.charCodeAt(8)|(l.charCodeAt(9)<<8);a=l.charCodeAt(10)|(l.charCodeAt(11)<<8);D=l.charCodeAt(12)|(l.charCodeAt(13)<<8);R=l.charCodeAt(14)|(l.charCodeAt(15)<<8);C=l.charCodeAt(16)|(l.charCodeAt(17)<<8);Q=l.charCodeAt(18)|(l.charCodeAt(19)<<8);B=l.charCodeAt(20)|(l.charCodeAt(21)<<8);P=l.charCodeAt(22)|(l.charCodeAt(23)<<8);A=l.charCodeAt(24)|(l.charCodeAt(25)<<8);O=l.charCodeAt(26)|(l.charCodeAt(27)<<8);z=l.charCodeAt(28)|(l.charCodeAt(29)<<8);N=l.charCodeAt(30)|(l.charCodeAt(31)<<8);y=l.charCodeAt(32)|(l.charCodeAt(33)<<8);M=l.charCodeAt(34)|(l.charCodeAt(35)<<8);x=l.charCodeAt(36)|(l.charCodeAt(37)<<8);K=l.charCodeAt(38)|(l.charCodeAt(39)<<8);i=l.charCodeAt(40)|(l.charCodeAt(41)<<8);r=l.charCodeAt(42)|(l.charCodeAt(43)<<8);h=l.charCodeAt(44)|(l.charCodeAt(45)<<8);q=l.charCodeAt(46)|(l.charCodeAt(47)<<8);g=l.charCodeAt(48)|(l.charCodeAt(49)<<8);p=l.charCodeAt(50)|(l.charCodeAt(51)<<8);f=l.charCodeAt(52)|(l.charCodeAt(53)<<8);o=l.charCodeAt(54)|(l.charCodeAt(55)<<8);e=l.charCodeAt(56)|(l.charCodeAt(57)<<8);n=l.charCodeAt(58)|(l.charCodeAt(59)<<8);d=l.charCodeAt(60)|(l.charCodeAt(61)<<8);m=l.charCodeAt(62)|(l.charCodeAt(63)<<8)}else{G=l.charCodeAt(0);c=l.charCodeAt(1);F=l.charCodeAt(2);b=l.charCodeAt(3);E=l.charCodeAt(4);a=l.charCodeAt(5);D=l.charCodeAt(6);R=l.charCodeAt(7);C=l.charCodeAt(8);Q=l.charCodeAt(9);B=l.charCodeAt(10);P=l.charCodeAt(11);A=l.charCodeAt(12);O=l.charCodeAt(13);z=l.charCodeAt(14);N=l.charCodeAt(15);y=l.charCodeAt(16);M=l.charCodeAt(17);x=l.charCodeAt(18);K=l.charCodeAt(19);i=l.charCodeAt(20);r=l.charCodeAt(21);h=l.charCodeAt(22);q=l.charCodeAt(23);g=l.charCodeAt(24);p=l.charCodeAt(25);f=l.charCodeAt(26);o=l.charCodeAt(27);e=l.charCodeAt(28);n=l.charCodeAt(29);d=l.charCodeAt(30);m=l.charCodeAt(31)}var H;s+=((j&I)|(~j&u))+G+42104;v+=((k&L)|(~k&w))+c+55146;v+=s>>16;s&=65535;v&=65535;H=(v>>9)|((s<<7)&65535);v=(s>>9)|((v<<7)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s&j)|(~s&I))+F+46934;w+=((v&k)|(~v&L))+b+59591;w+=u>>16;u&=65535;w&=65535;H=(w>>4)|((u<<12)&65535);w=(u>>4)|((w<<12)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u&s)|(~u&j))+E+28891;L+=((w&v)|(~w&k))+a+9248;L+=I>>16;I&=65535;L&=65535;H=(I>>15)|((L<<1)&65535);L=(L>>15)|((I<<1)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I&u)|(~I&s))+D+52974;k+=((L&w)|(~L&v))+R+49597;k+=j>>16;j&=65535;k&=65535;H=(j>>10)|((k<<6)&65535);k=(k>>10)|((j<<6)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j&I)|(~j&u))+C+4015;v+=((k&L)|(~k&w))+Q+62844;v+=s>>16;s&=65535;v&=65535;H=(v>>9)|((s<<7)&65535);v=(s>>9)|((v<<7)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s&j)|(~s&I))+B+50730;w+=((v&k)|(~v&L))+P+18311;w+=u>>16;u&=65535;w&=65535;H=(w>>4)|((u<<12)&65535);w=(u>>4)|((w<<12)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u&s)|(~u&j))+A+17939;L+=((w&v)|(~w&k))+O+43056;L+=I>>16;I&=65535;L&=65535;H=(I>>15)|((L<<1)&65535);L=(L>>15)|((I<<1)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I&u)|(~I&s))+z+38145;k+=((L&w)|(~L&v))+N+64838;k+=j>>16;j&=65535;k&=65535;H=(j>>10)|((k<<6)&65535);k=(k>>10)|((j<<6)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j&I)|(~j&u))+y+39128;v+=((k&L)|(~k&w))+M+27008;v+=s>>16;s&=65535;v&=65535;H=(v>>9)|((s<<7)&65535);v=(s>>9)|((v<<7)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s&j)|(~s&I))+x+63407;w+=((v&k)|(~v&L))+K+35652;w+=u>>16;u&=65535;w&=65535;H=(w>>4)|((u<<12)&65535);w=(u>>4)|((w<<12)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u&s)|(~u&j))+i+23473;L+=((w&v)|(~w&k))+r+65535;L+=I>>16;I&=65535;L&=65535;H=(I>>15)|((L<<1)&65535);L=(L>>15)|((I<<1)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I&u)|(~I&s))+h+55230;k+=((L&w)|(~L&v))+q+35164;k+=j>>16;j&=65535;k&=65535;H=(j>>10)|((k<<6)&65535);k=(k>>10)|((j<<6)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j&I)|(~j&u))+g+4386;v+=((k&L)|(~k&w))+p+27536;v+=s>>16;s&=65535;v&=65535;H=(v>>9)|((s<<7)&65535);v=(s>>9)|((v<<7)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s&j)|(~s&I))+f+29075;w+=((v&k)|(~v&L))+o+64920;w+=u>>16;u&=65535;w&=65535;H=(w>>4)|((u<<12)&65535);w=(u>>4)|((w<<12)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u&s)|(~u&j))+e+17294;L+=((w&v)|(~w&k))+n+42617;L+=I>>16;I&=65535;L&=65535;H=(I>>15)|((L<<1)&65535);L=(L>>15)|((I<<1)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I&u)|(~I&s))+d+2081;k+=((L&w)|(~L&v))+m+18868;k+=j>>16;j&=65535;k&=65535;H=(j>>10)|((k<<6)&65535);k=(k>>10)|((j<<6)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j&u)|(I&~u))+F+9570;v+=((k&w)|(L&~w))+b+63006;v+=s>>16;s&=65535;v&=65535;H=(v>>11)|((s<<5)&65535);v=(s>>11)|((v<<5)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s&I)|(j&~I))+A+45888;w+=((v&L)|(k&~L))+O+49216;w+=u>>16;u&=65535;w&=65535;H=(w>>7)|((u<<9)&65535);w=(u>>7)|((w<<9)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u&j)|(s&~j))+h+23121;L+=((w&k)|(v&~k))+q+9822;L+=I>>16;I&=65535;L&=65535;H=(L>>2)|((I<<14)&65535);L=(I>>2)|((L<<14)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I&s)|(u&~s))+G+51114;k+=((L&v)|(w&~v))+c+59830;k+=j>>16;j&=65535;k&=65535;H=(j>>12)|((k<<4)&65535);k=(k>>12)|((j<<4)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j&u)|(I&~u))+B+4189;v+=((k&w)|(L&~w))+P+54831;v+=s>>16;s&=65535;v&=65535;H=(v>>11)|((s<<5)&65535);v=(s>>11)|((v<<5)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s&I)|(j&~I))+i+5203;w+=((v&L)|(k&~L))+r+580;w+=u>>16;u&=65535;w&=65535;H=(w>>7)|((u<<9)&65535);w=(u>>7)|((w<<9)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u&j)|(s&~j))+d+59009;L+=((w&k)|(v&~k))+m+55457;L+=I>>16;I&=65535;L&=65535;H=(L>>2)|((I<<14)&65535);L=(I>>2)|((L<<14)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I&s)|(u&~s))+C+64456;k+=((L&v)|(w&~v))+Q+59347;k+=j>>16;j&=65535;k&=65535;H=(j>>12)|((k<<4)&65535);k=(k>>12)|((j<<4)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j&u)|(I&~u))+x+52710;v+=((k&w)|(L&~w))+K+8673;v+=s>>16;s&=65535;v&=65535;H=(v>>11)|((s<<5)&65535);v=(s>>11)|((v<<5)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s&I)|(j&~I))+e+2006;w+=((v&L)|(k&~L))+n+49975;w+=u>>16;u&=65535;w&=65535;H=(w>>7)|((u<<9)&65535);w=(u>>7)|((w<<9)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u&j)|(s&~j))+D+3463;L+=((w&k)|(v&~k))+R+62677;L+=I>>16;I&=65535;L&=65535;H=(L>>2)|((I<<14)&65535);L=(I>>2)|((L<<14)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I&s)|(u&~s))+y+5357;k+=((L&v)|(w&~v))+M+17754;k+=j>>16;j&=65535;k&=65535;H=(j>>12)|((k<<4)&65535);k=(k>>12)|((j<<4)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j&u)|(I&~u))+f+59653;v+=((k&w)|(L&~w))+o+43491;v+=s>>16;s&=65535;v&=65535;H=(v>>11)|((s<<5)&65535);v=(s>>11)|((v<<5)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s&I)|(j&~I))+E+41976;w+=((v&L)|(k&~L))+a+64751;w+=u>>16;u&=65535;w&=65535;H=(w>>7)|((u<<9)&65535);w=(u>>7)|((w<<9)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u&j)|(s&~j))+z+729;L+=((w&k)|(v&~k))+N+26479;L+=I>>16;I&=65535;L&=65535;H=(L>>2)|((I<<14)&65535);L=(I>>2)|((L<<14)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I&s)|(u&~s))+g+19594;k+=((L&v)|(w&~v))+p+36138;k+=j>>16;j&=65535;k&=65535;H=(j>>12)|((k<<4)&65535);k=(k>>12)|((j<<4)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j^I)^u)+B+14658;v+=((k^L)^w)+P+65530;v+=s>>16;s&=65535;v&=65535;H=(v>>12)|((s<<4)&65535);v=(s>>12)|((v<<4)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s^j)^I)+y+63105;w+=((v^k)^L)+M+34673;w+=u>>16;u&=65535;w&=65535;H=(w>>5)|((u<<11)&65535);w=(u>>5)|((w<<11)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u^s)^j)+h+24866;L+=((w^v)^k)+q+28061;L+=I>>16;I&=65535;L&=65535;H=(I>>16)|((L<<0)&65535);L=(L>>16)|((I<<0)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I^u)^s)+e+14348;k+=((L^w)^v)+n+64997;k+=j>>16;j&=65535;k&=65535;H=(j>>9)|((k<<7)&65535);k=(k>>9)|((j<<7)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j^I)^u)+F+59972;v+=((k^L)^w)+b+42174;v+=s>>16;s&=65535;v&=65535;H=(v>>12)|((s<<4)&65535);v=(s>>12)|((v<<4)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s^j)^I)+C+53161;w+=((v^k)^L)+Q+19422;w+=u>>16;u&=65535;w&=65535;H=(w>>5)|((u<<11)&65535);w=(u>>5)|((w<<11)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u^s)^j)+z+19296;L+=((w^v)^k)+N+63163;L+=I>>16;I&=65535;L&=65535;H=(I>>16)|((L<<0)&65535);L=(L>>16)|((I<<0)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I^u)^s)+i+48240;k+=((L^w)^v)+r+48831;k+=j>>16;j&=65535;k&=65535;H=(j>>9)|((k<<7)&65535);k=(k>>9)|((j<<7)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j^I)^u)+f+32454;v+=((k^L)^w)+o+10395;v+=s>>16;s&=65535;v&=65535;H=(v>>12)|((s<<4)&65535);v=(s>>12)|((v<<4)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s^j)^I)+G+10234;w+=((v^k)^L)+c+60065;w+=u>>16;u&=65535;w&=65535;H=(w>>5)|((u<<11)&65535);w=(u>>5)|((w<<11)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u^s)^j)+D+12421;L+=((w^v)^k)+R+54511;L+=I>>16;I&=65535;L&=65535;H=(I>>16)|((L<<0)&65535);L=(L>>16)|((I<<0)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I^u)^s)+A+7429;k+=((L^w)^v)+O+1160;k+=j>>16;j&=65535;k&=65535;H=(j>>9)|((k<<7)&65535);k=(k>>9)|((j<<7)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=((j^I)^u)+x+53305;v+=((k^L)^w)+K+55764;v+=s>>16;s&=65535;v&=65535;H=(v>>12)|((s<<4)&65535);v=(s>>12)|((v<<4)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=((s^j)^I)+g+39397;w+=((v^k)^L)+p+59099;w+=u>>16;u&=65535;w&=65535;H=(w>>5)|((u<<11)&65535);w=(u>>5)|((w<<11)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=((u^s)^j)+d+31992;L+=((w^v)^k)+m+8098;L+=I>>16;I&=65535;L&=65535;H=(I>>16)|((L<<0)&65535);L=(L>>16)|((I<<0)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=((I^u)^s)+E+22117;k+=((L^w)^v)+a+50348;k+=j>>16;j&=65535;k&=65535;H=(j>>9)|((k<<7)&65535);k=(k>>9)|((j<<7)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=(I^((65535-u)|j))+G+8772;v+=(L^((65535-w)|k))+c+62505;v+=s>>16;s&=65535;v&=65535;H=(v>>10)|((s<<6)&65535);v=(s>>10)|((v<<6)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=(j^((65535-I)|s))+z+65431;w+=(k^((65535-L)|v))+N+17194;w+=u>>16;u&=65535;w&=65535;H=(w>>6)|((u<<10)&65535);w=(u>>6)|((w<<10)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=(s^((65535-j)|u))+e+9127;L+=(v^((65535-k)|w))+n+43924;L+=I>>16;I&=65535;L&=65535;H=(L>>1)|((I<<15)&65535);L=(I>>1)|((L<<15)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=(u^((65535-s)|I))+B+41017;k+=(w^((65535-v)|L))+P+64659;k+=j>>16;j&=65535;k&=65535;H=(j>>11)|((k<<5)&65535);k=(k>>11)|((j<<5)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=(I^((65535-u)|j))+g+22979;v+=(L^((65535-w)|k))+p+25947;v+=s>>16;s&=65535;v&=65535;H=(v>>10)|((s<<6)&65535);v=(s>>10)|((v<<6)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=(j^((65535-I)|s))+D+52370;w+=(k^((65535-L)|v))+R+36620;w+=u>>16;u&=65535;w&=65535;H=(w>>6)|((u<<10)&65535);w=(u>>6)|((w<<10)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=(s^((65535-j)|u))+i+62589;L+=(v^((65535-k)|w))+r+65519;L+=I>>16;I&=65535;L&=65535;H=(L>>1)|((I<<15)&65535);L=(I>>1)|((L<<15)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=(u^((65535-s)|I))+F+24017;k+=(w^((65535-v)|L))+b+34180;k+=j>>16;j&=65535;k&=65535;H=(j>>11)|((k<<5)&65535);k=(k>>11)|((j<<5)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=(I^((65535-u)|j))+y+32335;v+=(L^((65535-w)|k))+M+28584;v+=s>>16;s&=65535;v&=65535;H=(v>>10)|((s<<6)&65535);v=(s>>10)|((v<<6)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=(j^((65535-I)|s))+d+59104;w+=(k^((65535-L)|v))+m+65068;w+=u>>16;u&=65535;w&=65535;H=(w>>6)|((u<<10)&65535);w=(u>>6)|((w<<10)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=(s^((65535-j)|u))+A+17172;L+=(v^((65535-k)|w))+O+41729;L+=I>>16;I&=65535;L&=65535;H=(L>>1)|((I<<15)&65535);L=(I>>1)|((L<<15)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=(u^((65535-s)|I))+f+4513;k+=(w^((65535-v)|L))+o+19976;k+=j>>16;j&=65535;k&=65535;H=(j>>11)|((k<<5)&65535);k=(k>>11)|((j<<5)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;s+=(I^((65535-u)|j))+C+32386;v+=(L^((65535-w)|k))+Q+63315;v+=s>>16;s&=65535;v&=65535;H=(v>>10)|((s<<6)&65535);v=(s>>10)|((v<<6)&65535);s=H+j;v+=k;if(s>65535){s&=65535;v++}v&=65535;u+=(j^((65535-I)|s))+h+62005;w+=(k^((65535-L)|v))+q+48442;w+=u>>16;u&=65535;w&=65535;H=(w>>6)|((u<<10)&65535);w=(u>>6)|((w<<10)&65535);u=H+s;w+=v;if(u>65535){u&=65535;w++}w&=65535;I+=(s^((65535-j)|u))+E+53947;L+=(v^((65535-k)|w))+a+10967;L+=I>>16;I&=65535;L&=65535;H=(L>>1)|((I<<15)&65535);L=(I>>1)|((L<<15)&65535);I=H+u;L+=w;if(I>65535){I&=65535;L++}L&=65535;j+=(u^((65535-s)|I))+x+54161;k+=(w^((65535-v)|L))+K+60294;k+=j>>16;j&=65535;k&=65535;H=(j>>11)|((k<<5)&65535);k=(k>>11)|((j<<5)&65535);j=H+I;k+=L;if(j>65535){j&=65535;k++}k&=65535;H=this.a_[0]+=s;this.a_[1]+=v;if(H>65535){this.a_[0]-=65536;this.a_[1]++}this.a_[1]&=65535;H=this.b_[0]+=j;this.b_[1]+=k;if(H>65535){this.b_[0]-=65536;this.b_[1]++}this.b_[1]&=65535;H=this.c_[0]+=I;this.c_[1]+=L;if(H>65535){this.c_[0]-=65536;this.c_[1]++}this.c_[1]&=65535;H=this.d_[0]+=u;this.d_[1]+=w;if(H>65535){this.d_[0]-=65536;this.d_[1]++}this.d_[1]&=65535},int2hex8:function(d){var b,f,a="";var e="0123456789abcdef";for(b=0;b<4;b++){f=d>>>(b*8);a+=e.charAt((f>>4)&15);a+=e.charAt(f&15)}return a},update_std:function(w,u){var z=this.a_,y=this.b_,x=this.c_,v=this.d_;var t,s,q,p,n,l,j,h,f,e,r,o,m,k,i,g;if(u==1){t=w.charCodeAt(0)|(w.charCodeAt(1)<<8)|(w.charCodeAt(2)<<16)|(w.charCodeAt(3)<<24);s=w.charCodeAt(4)|(w.charCodeAt(5)<<8)|(w.charCodeAt(6)<<16)|(w.charCodeAt(7)<<24);q=w.charCodeAt(8)|(w.charCodeAt(9)<<8)|(w.charCodeAt(10)<<16)|(w.charCodeAt(11)<<24);p=w.charCodeAt(12)|(w.charCodeAt(13)<<8)|(w.charCodeAt(14)<<16)|(w.charCodeAt(15)<<24);n=w.charCodeAt(16)|(w.charCodeAt(17)<<8)|(w.charCodeAt(18)<<16)|(w.charCodeAt(19)<<24);l=w.charCodeAt(20)|(w.charCodeAt(21)<<8)|(w.charCodeAt(22)<<16)|(w.charCodeAt(23)<<24);j=w.charCodeAt(24)|(w.charCodeAt(25)<<8)|(w.charCodeAt(26)<<16)|(w.charCodeAt(27)<<24);h=w.charCodeAt(28)|(w.charCodeAt(29)<<8)|(w.charCodeAt(30)<<16)|(w.charCodeAt(31)<<24);f=w.charCodeAt(32)|(w.charCodeAt(33)<<8)|(w.charCodeAt(34)<<16)|(w.charCodeAt(35)<<24);e=w.charCodeAt(36)|(w.charCodeAt(37)<<8)|(w.charCodeAt(38)<<16)|(w.charCodeAt(39)<<24);r=w.charCodeAt(40)|(w.charCodeAt(41)<<8)|(w.charCodeAt(42)<<16)|(w.charCodeAt(43)<<24);o=w.charCodeAt(44)|(w.charCodeAt(45)<<8)|(w.charCodeAt(46)<<16)|(w.charCodeAt(47)<<24);m=w.charCodeAt(48)|(w.charCodeAt(49)<<8)|(w.charCodeAt(50)<<16)|(w.charCodeAt(51)<<24);k=w.charCodeAt(52)|(w.charCodeAt(53)<<8)|(w.charCodeAt(54)<<16)|(w.charCodeAt(55)<<24);i=w.charCodeAt(56)|(w.charCodeAt(57)<<8)|(w.charCodeAt(58)<<16)|(w.charCodeAt(59)<<24);g=w.charCodeAt(60)|(w.charCodeAt(61)<<8)|(w.charCodeAt(62)<<16)|(w.charCodeAt(63)<<24)}else{t=w.charCodeAt(0)|(w.charCodeAt(1)<<16);s=w.charCodeAt(2)|(w.charCodeAt(3)<<16);q=w.charCodeAt(4)|(w.charCodeAt(5)<<16);p=w.charCodeAt(6)|(w.charCodeAt(7)<<16);n=w.charCodeAt(8)|(w.charCodeAt(9)<<16);l=w.charCodeAt(10)|(w.charCodeAt(11)<<16);j=w.charCodeAt(12)|(w.charCodeAt(13)<<16);h=w.charCodeAt(14)|(w.charCodeAt(15)<<16);f=w.charCodeAt(16)|(w.charCodeAt(17)<<16);e=w.charCodeAt(18)|(w.charCodeAt(19)<<16);r=w.charCodeAt(20)|(w.charCodeAt(21)<<16);o=w.charCodeAt(22)|(w.charCodeAt(23)<<16);m=w.charCodeAt(24)|(w.charCodeAt(25)<<16);k=w.charCodeAt(26)|(w.charCodeAt(27)<<16);i=w.charCodeAt(28)|(w.charCodeAt(29)<<16);g=w.charCodeAt(30)|(w.charCodeAt(31)<<16)}z+=t+3614090360+((y&x)|(~y&v));z=y+((z<<7)|(z>>>25));v+=s+3905402710+((z&y)|(~z&x));v=z+((v<<12)|(v>>>20));x+=q+606105819+((v&z)|(~v&y));x=v+((x<<17)|(x>>>15));y+=p+3250441966+((x&v)|(~x&z));y=x+((y<<22)|(y>>>10));z+=n+4118548399+((y&x)|(~y&v));z=y+((z<<7)|(z>>>25));v+=l+1200080426+((z&y)|(~z&x));v=z+((v<<12)|(v>>>20));x+=j+2821735955+((v&z)|(~v&y));x=v+((x<<17)|(x>>>15));y+=h+4249261313+((x&v)|(~x&z));y=x+((y<<22)|(y>>>10));z+=f+1770035416+((y&x)|(~y&v));z=y+((z<<7)|(z>>>25));v+=e+2336552879+((z&y)|(~z&x));v=z+((v<<12)|(v>>>20));x+=r+4294925233+((v&z)|(~v&y));x=v+((x<<17)|(x>>>15));y+=o+2304563134+((x&v)|(~x&z));y=x+((y<<22)|(y>>>10));z+=m+1804603682+((y&x)|(~y&v));z=y+((z<<7)|(z>>>25));v+=k+4254626195+((z&y)|(~z&x));v=z+((v<<12)|(v>>>20));x+=i+2792965006+((v&z)|(~v&y));x=v+((x<<17)|(x>>>15));y+=g+1236535329+((x&v)|(~x&z));y=x+((y<<22)|(y>>>10));z+=s+4129170786+((y&v)|(x&~v));z=y+((z<<5)|(z>>>27));v+=j+3225465664+((z&x)|(y&~x));v=z+((v<<9)|(v>>>23));x+=o+643717713+((v&y)|(z&~y));x=v+((x<<14)|(x>>>18));y+=t+3921069994+((x&z)|(v&~z));y=x+((y<<20)|(y>>>12));z+=l+3593408605+((y&v)|(x&~v));z=y+((z<<5)|(z>>>27));v+=r+38016083+((z&x)|(y&~x));v=z+((v<<9)|(v>>>23));x+=g+3634488961+((v&y)|(z&~y));x=v+((x<<14)|(x>>>18));y+=n+3889429448+((x&z)|(v&~z));y=x+((y<<20)|(y>>>12));z+=e+568446438+((y&v)|(x&~v));z=y+((z<<5)|(z>>>27));v+=i+3275163606+((z&x)|(y&~x));v=z+((v<<9)|(v>>>23));x+=p+4107603335+((v&y)|(z&~y));x=v+((x<<14)|(x>>>18));y+=f+1163531501+((x&z)|(v&~z));y=x+((y<<20)|(y>>>12));z+=k+2850285829+((y&v)|(x&~v));z=y+((z<<5)|(z>>>27));v+=q+4243563512+((z&x)|(y&~x));v=z+((v<<9)|(v>>>23));x+=h+1735328473+((v&y)|(z&~y));x=v+((x<<14)|(x>>>18));y+=m+2368359562+((x&z)|(v&~z));y=x+((y<<20)|(y>>>12));z+=l+4294588738+((y^x)^v);z=y+((z<<4)|(z>>>28));v+=f+2272392833+((z^y)^x);v=z+((v<<11)|(v>>>21));x+=o+1839030562+((v^z)^y);x=v+((x<<16)|(x>>>16));y+=i+4259657740+((x^v)^z);y=x+((y<<23)|(y>>>9));z+=s+2763975236+((y^x)^v);z=y+((z<<4)|(z>>>28));v+=n+1272893353+((z^y)^x);v=z+((v<<11)|(v>>>21));x+=h+4139469664+((v^z)^y);x=v+((x<<16)|(x>>>16));y+=r+3200236656+((x^v)^z);y=x+((y<<23)|(y>>>9));z+=k+681279174+((y^x)^v);z=y+((z<<4)|(z>>>28));v+=t+3936430074+((z^y)^x);v=z+((v<<11)|(v>>>21));x+=p+3572445317+((v^z)^y);x=v+((x<<16)|(x>>>16));y+=j+76029189+((x^v)^z);y=x+((y<<23)|(y>>>9));z+=e+3654602809+((y^x)^v);z=y+((z<<4)|(z>>>28));v+=m+3873151461+((z^y)^x);v=z+((v<<11)|(v>>>21));x+=g+530742520+((v^z)^y);x=v+((x<<16)|(x>>>16));y+=q+3299628645+((x^v)^z);y=x+((y<<23)|(y>>>9));z+=t+4096336452+(x^(~v|y));z=y+((z<<6)|(z>>>26));v+=h+1126891415+(y^(~x|z));v=z+((v<<10)|(v>>>22));x+=i+2878612391+(z^(~y|v));x=v+((x<<15)|(x>>>17));y+=l+4237533241+(v^(~z|x));y=x+((y<<21)|(y>>>11));z+=m+1700485571+(x^(~v|y));z=y+((z<<6)|(z>>>26));v+=p+2399980690+(y^(~x|z));v=z+((v<<10)|(v>>>22));x+=r+4293915773+(z^(~y|v));x=v+((x<<15)|(x>>>17));y+=s+2240044497+(v^(~z|x));y=x+((y<<21)|(y>>>11));z+=f+1873313359+(x^(~v|y));z=y+((z<<6)|(z>>>26));v+=g+4264355552+(y^(~x|z));v=z+((v<<10)|(v>>>22));x+=j+2734768916+(z^(~y|v));x=v+((x<<15)|(x>>>17));y+=k+1309151649+(v^(~z|x));y=x+((y<<21)|(y>>>11));z+=n+4149444226+(x^(~v|y));z=y+((z<<6)|(z>>>26));v+=o+3174756917+(y^(~x|z));v=z+((v<<10)|(v>>>22));x+=q+718787259+(z^(~y|v));x=v+((x<<15)|(x>>>17));y+=e+3951481745+(v^(~z|x));y=x+((y<<21)|(y>>>11));this.a_=(this.a_+z)&4294967295;this.b_=(this.b_+y)&4294967295;this.c_=(this.c_+x)&4294967295;this.d_=(this.d_+v)&4294967295},fillzero:function(c){var a="";for(var b=0;b<c;b++){a+="\x00"}return a},main:function(b,c,f,a,e){if(e==1){var d=c*8;while(c>=64){a[f](b,e);b=b.substr(64);c-=64}b+="\x80";if(c>=56){b+=this.fillzero(63-c);a[f](b,e);b=this.fillzero(56)}else{b+=this.fillzero(55-c)}b+=String.fromCharCode(d&255,(d>>>8)&255,(d>>>16)&255,d>>>24);b+="\x00\x00\x00\x00";a[f](b,e)}else{var d=c*16;while(c>=32){a[f](b,e);b=b.substr(32);c-=32}b+="\x80";if(c>=28){b+=this.fillzero(31-c);a[f](b,e);b=this.fillzero(28)}else{b+=this.fillzero(27-c)}b+=String.fromCharCode(d&65535,d>>>16);b+="\x00\x00";a[f](b,e)}},VERSION:"1.0",BY_ASCII:0,BY_UTF16:1,calc_Fx:function(b,a){var c=(arguments.length==2&&a==this.BY_UTF16)?2:1;this.a_=[8961,26437];this.b_=[43913,61389];this.c_=[56574,39098];this.d_=[21622,4146];this.main(b,b.length,"update_Fx",this,c);return this.int2hex8_Fx(this.a_)+this.int2hex8_Fx(this.b_)+this.int2hex8_Fx(this.c_)+this.int2hex8_Fx(this.d_)},calc_std:function(b,a){var c=(arguments.length==2&&a==this.BY_UTF16)?2:1;this.a_=1732584193;this.b_=4023233417;this.c_=2562383102;this.d_=271733878;this.main(b,b.length,"update_std",this,c);return this.int2hex8(this.a_)+this.int2hex8(this.b_)+this.int2hex8(this.c_)+this.int2hex8(this.d_)}}};new function(){CybozuLabs.MD5.calc=navigator.userAgent.match(/Firefox/)?CybozuLabs.MD5.calc_Fx:CybozuLabs.MD5.calc_std};
